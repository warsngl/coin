import{r as g,c as C,o as n,a as c,b as a,w as _,v,d as k,F as u,e as p,t as h,f as b,g as m,h as B,n as w,i as E,C as N,P as x,L as D,j as U,k as R,p as I,l as L,m as O,q as S,s as T}from"./vendor.0fff18e1.js";const V=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&l(d)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}};V();function Q(e,t){const r=g("router-view");return n(),C(r)}var A=(e,t)=>{const r=e.__vccOpts||e;for(const[l,i]of t)r[l]=i;return r};const F={};var P=A(F,[["render",Q]]);var J="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAABmJLR0QA/wD/AP+gvaeTAAAAoElEQVRIie2UQQ6CQAxFO95BIguuZwLHhYV7PchjU12MnUIdIprwV1DgvfkDQeRINGi24p22An1FADRAv3STu0UKaQrzSR8fPhIAZ2AEbkBrzNFrl7AggzxBbQheEmT1J+f4besWBdYKC238lVsCr372PtbBDcHg1afwRa0W6HkfhkQEtfmvX8UugpQPgLuIdFXQlF5cq8FVRB41giO/lRkNAEIMkf189QAAAABJRU5ErkJggg==";const M={class:"line"},H=a("label",{for:"add"},"Add coin",-1),z={class:"ul"},K={class:"line"},j=["for"],Y=["onClick"],q={class:"line__price"},W=["onUpdate:modelValue","id"],G={class:"line"},X={class:"mr-1"},Z={key:0,class:"chart"},$={key:1},ee={key:0,class:"ul"},te={key:1},se={key:2,class:"ul"},re=["onClick"],oe={class:"text-sm"},ie={class:"ml-auto"},ae=["onClick"];function ne(e,t,r,l,i,s){const d=g("Line");return n(),c(u,null,[a("div",M,[H,_(a("input",{class:"line__price",id:"add","onUpdate:modelValue":t[0]||(t[0]=o=>e.coin=o),onKeydown:t[1]||(t[1]=k((...o)=>s.addCoin&&s.addCoin(...o),["enter"]))},null,544),[[v,e.coin]]),a("button",{onClick:t[2]||(t[2]=(...o)=>s.addCoin&&s.addCoin(...o))},"+")]),a("ul",z,[(n(!0),c(u,null,p(e.coins,(o,f)=>(n(),c("li",K,[a("label",{class:"flex items-center",for:o.c},[B(h(o.c),1),a("span",{class:"cursor-pointer text-xs ml-2 text-red-600 hover:text-white",onClick:y=>s.remove(f)},"x",8,Y)],8,j),a("div",q,[_(a("input",{"onUpdate:modelValue":y=>o.v=y,id:o.c,type:"Number"},null,8,W),[[v,o.v]]),a("span",null,h(o.p),1)])]))),256))]),a("div",G,[a("p",{ref:"cash"},"Your cash: "+h(Math.trunc(e.cash)),513),a("button",X,[a("img",{src:J,onClick:t[3]||(t[3]=o=>e.isChart=!e.isChart)})]),a("p",{class:"underline italic cursor-pointer",onClick:t[4]||(t[4]=(...o)=>s.refresh&&s.refresh(...o))},"refresh")]),e.isChart?(n(),c("div",Z,[b(d,{id:"my-chart-id",data:s.chartData,options:s.chartOptions},null,8,["data","options"])])):(n(),c("div",$,[typeof s.errors=="object"?(n(),c("ul",ee,[(n(!0),c(u,null,p(s.errors,o=>(n(),c("li",{key:o.coin},[a("p",null,h(o.coin)+": "+h(o.error),1)]))),128))])):m("",!0),typeof s.errors=="string"?(n(),c("p",te,h(s.errors),1)):m("",!0),e.history.length>0?(n(),c("ul",se,[(n(!0),c(u,null,p(e.history,o=>(n(),c("li",{class:w(["line w-full cursor-pointer hover:underline",s.changeInBalance(o.date).at(0)=="-"?"text-red":"text-green"]),key:o.date,onClick:f=>s.backToDate(o.date)},[a("p",oe,h(s.formatDate(o.date)),1),a("span",ie,h(Math.trunc(o.cash)||0)+" "+h(s.changeInBalance(o.date)),1),a("span",{class:"cursor-pointer text-xs ml-2 text-red-600 hover:text-white",onClick:E(f=>s.clear(o.date),["self"])},"x",8,ae)],10,re))),128))])):m("",!0)]))],64)}N.register(x,D,U,R,I);const ce={data:()=>({coin:"",coins:[],cash:0,history:[],otherErrors:[],isChart:!1}),methods:{async refresh(){this.cash=0,this.otherErrors=[],this.errors=[],await Promise.all(this.coins.map(async(e,t)=>{await fetch(`https://min-api.cryptocompare.com/data/pricemulti?fsyms=${e.c}&tsyms=RUB&api_key=b5a5b68758c1e3428691ea0f0fcac1dfe98df8c99dba00cfac673e16b887c436`).then(r=>r.json()).then(r=>{this.cash+=+r[e.c].RUB*e.v,this.coins[t].p=+r[e.c].RUB}).catch(async r=>{console.log(r),this.otherErrors.push({coin:e.c,error:r+""}),await fetch(`https://min-api.cryptocompare.com/data/pricemulti?fsyms=${e.c}&tsyms=BTC&api_key=b5a5b68758c1e3428691ea0f0fcac1dfe98df8c99dba00cfac673e16b887c436`).then(l=>l.json()).then(async l=>{let i=+l[e.c].BTC*e.v;await fetch("https://min-api.cryptocompare.com/data/pricemulti?fsyms=BTC&tsyms=RUB&api_key=b5a5b68758c1e3428691ea0f0fcac1dfe98df8c99dba00cfac673e16b887c436").then(s=>s.json()).then(s=>{this.cash+=+s.BTC.RUB*i,this.coins[t].p=+s.BTC.RUB*i})})})})).finally(()=>{this.history.push({date:new Date,coins:this.coins,cash:this.cash}),localStorage.setItem("dw-history",JSON.stringify(this.history))})},addCoin(){this.coin.length>0?(this.$refs.cash.focus(),this.coins.push({c:this.coin.toUpperCase(),v:0}),this.coin="",this.errors=[]):this.errors="Enter coin name"},backToDate(e){let t=this.history.find(r=>r.date==e);t?(this.coins=JSON.parse(JSON.stringify(t.coins)),this.otherErrors=""):this.otherErrors="Cannot find this date",console.log(e,t)},remove(e){this.coins=this.coins.filter((t,r)=>r!==e)},clear(e){this.history=this.history.filter(t=>t.date!==e),localStorage.setItem("dw-history",JSON.stringify(this.history))},formatDate(e){const t=new Date(e);let r=t.getMinutes();return t.getMonth()+1+"."+t.getDate()+"/"+t.getHours()+":"+(r<10?"0"+r:r)},changeInBalance(e){if(e){let t=this.history.findIndex(l=>e==l.date);if(t==0)return"";let r=((this.history[t].cash/this.history[t-1].cash-1)*100).toFixed(2);return r>0?"+"+r+"%":r+"%"}else return""}},watch:{},computed:{errors:{get(){return this.otherErrors.length>0&&this.otherErrors||this.coins.length==0&&"No saved coins yet.."||this.history.length==0&&"No history yet.."},set(e){this.otherErrors=e}},chartData(){let e=this.history.map(r=>this.formatDate(r.date).split("/")[0]),t=[{backgroundColor:"#000",borderColor:"#fa0",color:"#fa0",data:this.history.map(r=>r.cash)}];return{labels:e,datasets:t}},chartOptions(){return{responsive:!0,scales:{x:{ticks:{color:"#fff",borderColor:"red",font:{size:8}}},y:{ticks:{color:"#fff",borderColor:"green",font:{size:8}}}}}}},mounted(){const e=JSON.parse(localStorage.getItem("dw-history"));(e==null?void 0:e.length)>0&&(this.history=e,this.coins=e.at(-1).coins,this.cash=e.at(-1).cash)},components:{Line:L}};var le=A(ce,[["render",ne]]);const he=[{path:"/",component:le}],de=O({history:S(),routes:he});T(P).use(de).mount("#app");
